<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mbzuai-hackathon-2023 – challenges</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">mbzuai-hackathon-2023</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./challenges.html">Competition Challenges</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HPP Hackathon</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./challenges.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Competition Challenges</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./submission_instructions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Submission instructions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./leaderboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Leaderboard</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./platform_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pheno_utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pheno-utils</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Datasets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Available datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/1-population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-population</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/2-anthropometrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2-anthropometrics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/3-fundus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3-fundus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/4-liver_ultrasound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4-liver_ultrasound</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/5-diet_logging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5-diet_logging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/6-hand_grip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6-hand_grip</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/7-blood_pressure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7-blood_pressure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/8-serum_lipidomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8-serum_lipidomics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/9-sleep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9-sleep</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/10-vascular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10-vascular</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/11-body_composition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-body_composition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/12-carotid_ultrasound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12-carotid_ultrasound</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/13-gut_microbiome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13-gut_microbiome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/14-human_genetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14-human_genetics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/15-ecg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15-ecg</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/16-blood_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16-blood_tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/17-cgm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17-cgm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/21-medical_conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">21-medical_conditions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets/22-bone_density.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">22-bone_density</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#competition-challenges" id="toc-competition-challenges" class="nav-link active" data-scroll-target="#competition-challenges">Competition Challenges</a>
  <ul class="collapse">
  <li><a href="#predictive-challenge---phenotypic-age-prediction" id="toc-predictive-challenge---phenotypic-age-prediction" class="nav-link" data-scroll-target="#predictive-challenge---phenotypic-age-prediction">1. Predictive Challenge - Phenotypic Age Prediction</a></li>
  <li><a href="#creative-challenge" id="toc-creative-challenge" class="nav-link" data-scroll-target="#creative-challenge">2. Creative Challenge</a></li>
  <li><a href="#challenges-deadlines" id="toc-challenges-deadlines" class="nav-link" data-scroll-target="#challenges-deadlines">Challenges deadlines:</a>
  <ul class="collapse">
  <li><a href="#day-1-25" id="toc-day-1-25" class="nav-link" data-scroll-target="#day-1-25">Day 1 (2/5)</a></li>
  <li><a href="#day-2-35" id="toc-day-2-35" class="nav-link" data-scroll-target="#day-2-35">Day 2 (3/5)</a></li>
  </ul></li>
  <li><a href="#general-notes" id="toc-general-notes" class="nav-link" data-scroll-target="#general-notes">General notes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="competition-challenges" class="level1">
<h1>Competition Challenges</h1>
<p>Aging leads to molecular and physiological changes throughout the body’s tissues, increasing vulnerability to various illnesses. Identifying unique aging markers is vital, as each individual’s aging trajectory is shaped by a blend of genetic and environmental factors. Phenotypic age, determined by molecular and physiological markers, is deemed to more accurately depict human aging compared to merely tallying years. Deep phenotype longitudinal cohorts are powerful tools for advancing healthy aging research by providing detailed information on an individual’s physical and medical characteristics over time. This data enables researchers to pinpoint risk factors for age-related diseases, develop personalized interventions, and inform clinical trial design, resulting in more effective treatments and improved health outcomes for older adults.</p>
<section id="predictive-challenge---phenotypic-age-prediction" class="level2">
<h2 class="anchored" data-anchor-id="predictive-challenge---phenotypic-age-prediction">1. Predictive Challenge - Phenotypic Age Prediction</h2>
<p>Your objective is to forecast an individual’s actual chronological age by leveraging all available phenotype datasets. Your performance will be assessed empirically using a withheld test set, with the mean absolute error (MAE) serving as the evaluation criterion. Throughout the event, two leaderboard test sets will be distributed, allowing teams to monitor their progress and compare results. Upon the hackathon’s conclusion, a final test set will be used to establish the ultimate leaderboard.</p>
<p>Submission instructions and format can be found in the <code>example_notebooks\prediction_example.ipynb</code> notebook on the platform.</p>
<p>The final score will be composed of:<br>
- 80%: Leaderboard <strong>rank</strong> on empirical MAE on the test set.<br>
- 20%: Model novelty and usage of unstructured datasets. This is presented by the groups and <strong>ranked</strong> by the judges.</p>
<p>Examples for model novelty:<br>
- Simple: Vanilla scikit-learn and gradient boosting trees (CatBoost, XGBoost, LightGBM)<br>
- Complex: Custom models, bespoke probabilistic models, leveraging domain expertise</p>
<p>Examples of unstructured datasets:<br>
- Simple: All tabular features<br>
- Complex: Images (fundus), time series (sleep monitor, CGM, ECG, diet logging)</p>
</section>
<section id="creative-challenge" class="level2">
<h2 class="anchored" data-anchor-id="creative-challenge">2. Creative Challenge</h2>
<p>This challenge is an open challenge to find the best application of deep phenotype longitudinal cohorts to promote healthy aging. The output of this challenge is a presentation of a proof-of-concept of such an application using the available data at hand.</p>
<p>Use the following template for your presentation: <a href="https://docs.google.com/presentation/d/1MXjvLig6ZIgN-6RLjk2FamO4y-XHLNRH/edit?usp=share_link&amp;ouid=117022341077434935776&amp;rtpof=true&amp;sd=true">Presentation template slides</a></p>
<p>The presentation should take 6-8 minutes. And another 2 minutes will be given at the end for any questions.</p>
<p>The presentation should briefly cover:<br>
1. Scientific or clinical background and rationale for the application.<br>
2. Main idea<br>
3. Proof-of-concept of the application on the HPP dataset<br>
4. Future directions</p>
<p>Example use cases may include (but not limited to):<br>
1. Identifying risk factors<br>
2. Personalized interventions<br>
3. Precision medicine<br>
4. Biomarker discovery<br>
5. Assisting clinical trial design</p>
<p>Specific examples (feel free to be creative and come up with your own):<br>
1. Omics-mediated glucose-diet personalized response with respect to age. Utilize microbiome, serum metabolomics, and genetics datasets. See for example: <a href="https://www.sciencedirect.com/science/article/pii/S0092867415014816">Personalized Nutrition by Prediction of Glycemic Responses</a>.<br>
2. Predict <em>cardiovascular age</em> from wearable devices data (such as sleep monitoring PAT signal or ECG).<br>
3. <em>Fragility scores</em> using bone density and body composition data.<br>
4. Utilize the retinal microvasculature found in fundus images as <em>a window to the heart</em>. See <a href="https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.121.057709">Deep Learning of the Retina Enables Phenome- and Genome-Wide Analyses of the Microvasculature</a>.<br>
5. Genetics and interaction with aging. See for example: <a href="https://elifesciences.org/articles/82364">Longitudinal fundus imaging and its genome-wide association analysis provide evidence for a human retinal aging clock</a>.<br>
6. Semi-supervised learning on large cohorts for enhancing small cohort data. See <a href="https://www.nature.com/articles/s41551-022-00914-1">Self-supervised learning in medicine and healthcare and Self-supervised Learning for Human Activity Recognition Using 700,000 Person-days of Wearable Data</a>.<br>
7. Sleep architecture (sleep stage patterns) and associations with health and disease.<br>
8. Clinical trial design - smart matching of healthy individuals to a smaller cohort.</p>
<p>Please do come up with your own ideas!</p>
</section>
<section id="challenges-deadlines" class="level2">
<h2 class="anchored" data-anchor-id="challenges-deadlines">Challenges deadlines:</h2>
<section id="day-1-25" class="level3">
<h3 class="anchored" data-anchor-id="day-1-25">Day 1 (2/5)</h3>
<table class="table">
<thead>
<tr class="header">
<th>Time</th>
<th>Event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>11:30</td>
<td>Kickoff teamwork begins</td>
</tr>
<tr class="even">
<td>17:30</td>
<td>Leaderboard submission #1 (Predictive Challenge)</td>
</tr>
</tbody>
</table>
</section>
<section id="day-2-35" class="level3">
<h3 class="anchored" data-anchor-id="day-2-35">Day 2 (3/5)</h3>
<table class="table">
<thead>
<tr class="header">
<th>Time</th>
<th>Event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>07:30</td>
<td>Leaderboard submission #2 (Predictive Challenge)</td>
</tr>
<tr class="even">
<td>10:30</td>
<td>Predictive + Creative final submission deadline</td>
</tr>
<tr class="odd">
<td>11:00</td>
<td>Team presentations (Predictive + Creative)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="general-notes" class="level2">
<h2 class="anchored" data-anchor-id="general-notes">General notes</h2>
<ol type="1">
<li>You are one of the first to use the platform and unique datasets. Be patient with issues and we will help you overcome them.<br>
</li>
<li>Platform resource usage - please limit yourself to 1 workspace per user.</li>
<li>Keep the compettiton clean. None of us want to win the wrong way. If you come across something that would seem unfair (target data leakage, ability to observe other teams shared folder) - please let us know.</li>
<li>Support available througoput the event.</li>
<li>Have fun! Build great applications with the data.</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>